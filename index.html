<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PartexSmartOS 16.2 Ultra - WebTV Betriebssystem</title>
<style>
/* -------------------- CSS Reset & Grundlagen -------------------- */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

:root {
  --primary-color: #00aaff;
  --secondary-color: #0077cc;
  --dark-bg: #0b0b0b;
  --dark-card: #222;
  --light-bg: #f0f0f0;
  --light-card: #ffffff;
  --text-dark: #111;
  --text-light: #ffffff;
  --success: #2ecc71;
  --warning: #f39c12;
  --danger: #e74c3c;
  --shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
  --radius: 15px;
  --transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
}

body {
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  background: var(--dark-bg);
  color: var(--text-light);
  overflow: hidden;
  transition: var(--transition);
  height: 100vh;
}

body.light-theme {
  background: var(--light-bg);
  color: var(--text-dark);
}

/* -------------------- Header & Systemleiste -------------------- */
.system-bar {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 10px 20px;
  background: rgba(0, 0, 0, 0.7);
  backdrop-filter: blur(10px);
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
  position: relative;
  z-index: 1000;
}

.logo {
  display: flex;
  align-items: center;
  gap: 10px;
  font-weight: bold;
  font-size: 1.5em;
  letter-spacing: 1px;
}

.logo-icon {
  width: 30px;
  height: 30px;
  background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
}

.system-info {
  display: flex;
  gap: 20px;
  font-size: 0.9em;
  opacity: 0.8;
}

/* -------------------- Hauptcontainer & Startscreen -------------------- */
.container {
  height: calc(100vh - 60px);
  display: flex;
  flex-direction: column;
  padding: 20px;
  position: relative;
}

.screen-title {
  text-align: center;
  margin: 20px 0 30px;
  font-size: 2.5em;
  letter-spacing: 2px;
  text-shadow: 0 0 10px rgba(0, 170, 255, 0.5);
  background: linear-gradient(90deg, var(--primary-color), #00ffaa);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

/* -------------------- App-Kacheln -------------------- */
.menu-grid {
  display: flex;
  justify-content: center;
  gap: 25px;
  flex-wrap: wrap;
  max-width: 1200px;
  margin: 0 auto;
  padding: 20px;
  transition: var(--transition);
}

.app-tile {
  width: 200px;
  height: 140px;
  background: var(--dark-card);
  border-radius: var(--radius);
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  cursor: pointer;
  transition: var(--transition);
  box-shadow: var(--shadow);
  position: relative;
  overflow: hidden;
  border: 2px solid transparent;
}

.app-tile::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
  transition: 0.5s;
}

.app-tile:hover::before {
  left: 100%;
}

.light-theme .app-tile {
  background: var(--light-card);
  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
}

.app-tile.focused {
  transform: scale(1.15) translateY(-10px);
  border-color: var(--primary-color);
  box-shadow: 0 15px 30px rgba(0, 170, 255, 0.5);
  z-index: 10;
}

.app-icon {
  font-size: 2.5em;
  margin-bottom: 10px;
  transition: var(--transition);
}

.app-tile:hover .app-icon,
.app-tile.focused .app-icon {
  transform: scale(1.2);
}

.app-name {
  font-size: 1.1em;
  font-weight: 600;
  text-align: center;
}

/* -------------------- Overlay Screens -------------------- */
.overlay-screen {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.95);
  display: none;
  flex-direction: column;
  z-index: 2000;
  animation: fadeIn 0.3s ease-out;
}

.overlay-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 20px;
  background: rgba(0, 0, 0, 0.8);
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.overlay-content {
  flex: 1;
  padding: 20px;
  overflow: auto;
}

/* -------------------- App Store -------------------- */
.app-store-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
  gap: 20px;
  padding: 20px;
  max-height: 70vh;
  overflow-y: auto;
}

.store-app {
  background: var(--dark-card);
  border-radius: var(--radius);
  padding: 20px;
  text-align: center;
  cursor: pointer;
  transition: var(--transition);
  border: 2px solid transparent;
}

.store-app:hover,
.store-app.focused {
  transform: translateY(-5px);
  border-color: var(--primary-color);
  box-shadow: 0 10px 20px rgba(0, 170, 255, 0.3);
}

.app-badge {
  position: absolute;
  top: 10px;
  right: 10px;
  background: var(--primary-color);
  color: white;
  padding: 3px 8px;
  border-radius: 10px;
  font-size: 0.7em;
  font-weight: bold;
}

/* -------------------- Film-Simulation -------------------- */
.films-container {
  display: flex;
  gap: 25px;
  padding: 20px;
  overflow-x: auto;
  max-width: 100%;
  scroll-behavior: smooth;
}

.film-item {
  flex: 0 0 280px;
  height: 400px;
  background-size: cover;
  background-position: center;
  border-radius: var(--radius);
  display: flex;
  flex-direction: column;
  justify-content: flex-end;
  cursor: pointer;
  transition: var(--transition);
  position: relative;
  overflow: hidden;
  box-shadow: var(--shadow);
}

.film-item::before {
  content: '';
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  height: 70%;
  background: linear-gradient(to top, rgba(0, 0, 0, 0.9), transparent);
}

.film-item.focused {
  transform: scale(1.05);
  box-shadow: 0 20px 40px rgba(0, 170, 255, 0.5);
}

.film-info {
  position: relative;
  z-index: 2;
  padding: 20px;
  color: white;
}

.film-title {
  font-size: 1.4em;
  font-weight: bold;
  margin-bottom: 5px;
}

.film-year {
  opacity: 0.8;
  font-size: 0.9em;
}

/* -------------------- Video Player -------------------- */
.video-player-container {
  width: 90%;
  max-width: 1200px;
  margin: 0 auto;
  position: relative;
}

.video-player {
  width: 100%;
  height: 70vh;
  border-radius: var(--radius);
  background: #000;
}

.player-controls {
  display: flex;
  justify-content: center;
  gap: 15px;
  margin-top: 20px;
}

.control-btn {
  padding: 12px 25px;
  background: var(--dark-card);
  border: none;
  border-radius: 8px;
  color: white;
  cursor: pointer;
  transition: var(--transition);
  font-weight: bold;
}

.control-btn:hover {
  background: var(--primary-color);
  transform: translateY(-2px);
}

/* -------------------- Mini-Apps -------------------- */
.mini-app {
  background: var(--dark-card);
  border-radius: var(--radius);
  padding: 30px;
  max-width: 500px;
  margin: 0 auto;
  box-shadow: var(--shadow);
}

.light-theme .mini-app {
  background: var(--light-card);
}

.calculator {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 10px;
}

.calc-display {
  grid-column: 1 / -1;
  background: #111;
  padding: 20px;
  border-radius: 10px;
  text-align: right;
  font-size: 2em;
  margin-bottom: 10px;
  min-height: 80px;
  word-break: break-all;
  overflow: auto;
}

.calc-btn {
  padding: 20px;
  border: none;
  border-radius: 10px;
  background: #333;
  color: white;
  font-size: 1.2em;
  cursor: pointer;
  transition: var(--transition);
}

.calc-btn:hover {
  background: #444;
}

.calc-btn.operator {
  background: var(--primary-color);
}

.notes-app textarea {
  width: 100%;
  height: 300px;
  background: #111;
  border: 2px solid #333;
  border-radius: 10px;
  padding: 20px;
  color: white;
  font-size: 1em;
  resize: none;
}

.light-theme .notes-app textarea {
  background: white;
  color: var(--text-dark);
  border-color: #ddd;
}

/* -------------------- Settings Panel -------------------- */
.settings-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
  gap: 20px;
  padding: 20px;
}

.setting-card {
  background: var(--dark-card);
  border-radius: var(--radius);
  padding: 25px;
  transition: var(--transition);
}

.light-theme .setting-card {
  background: var(--light-card);
}

.setting-title {
  font-size: 1.2em;
  margin-bottom: 15px;
  color: var(--primary-color);
}

.setting-option {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 15px 0;
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.light-theme .setting-option {
  border-bottom-color: rgba(0, 0, 0, 0.1);
}

.toggle-switch {
  position: relative;
  width: 60px;
  height: 30px;
}

.toggle-switch input {
  opacity: 0;
  width: 0;
  height: 0;
}

.toggle-slider {
  position: absolute;
  cursor: pointer;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: #333;
  transition: .4s;
  border-radius: 34px;
}

.toggle-slider:before {
  position: absolute;
  content: "";
  height: 22px;
  width: 22px;
  left: 4px;
  bottom: 4px;
  background-color: white;
  transition: .4s;
  border-radius: 50%;
}

input:checked + .toggle-slider {
  background-color: var(--primary-color);
}

input:checked + .toggle-slider:before {
  transform: translateX(30px);
}

.volume-slider {
  width: 200px;
  height: 8px;
  -webkit-appearance: none;
  background: #333;
  border-radius: 4px;
  outline: none;
}

.volume-slider::-webkit-slider-thumb {
  -webkit-appearance: none;
  width: 22px;
  height: 22px;
  background: var(--primary-color);
  border-radius: 50%;
  cursor: pointer;
}

/* -------------------- Animationen -------------------- */
@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes slideIn {
  from { transform: translateY(20px); opacity: 0; }
  to { transform: translateY(0); opacity: 1; }
}

@keyframes pulse {
  0% { transform: scale(1); }
  50% { transform: scale(1.05); }
  100% { transform: scale(1); }
}

@keyframes glow {
  0%, 100% { box-shadow: 0 0 10px var(--primary-color); }
  50% { box-shadow: 0 0 20px var(--primary-color); }
}

.focused {
  animation: pulse 2s infinite, glow 1.5s infinite;
}

/* -------------------- Utility Classes -------------------- */
.btn {
  padding: 12px 30px;
  background: var(--primary-color);
  color: white;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  font-size: 1em;
  font-weight: bold;
  transition: var(--transition);
  display: flex;
  align-items: center;
  gap: 10px;
}

.btn:hover {
  background: var(--secondary-color);
  transform: translateY(-2px);
}

.btn-secondary {
  background: #666;
}

.btn-danger {
  background: var(--danger);
}

.hidden {
  display: none !important;
}

.visible {
  display: flex !important;
}

.scrollable {
  overflow-y: auto;
}

/* -------------------- Responsive Design -------------------- */
@media (max-width: 1024px) {
  .menu-grid {
    gap: 15px;
  }
  
  .app-tile {
    width: 160px;
    height: 120px;
  }
  
  .film-item {
    flex: 0 0 220px;
    height: 320px;
  }
}

@media (max-width: 768px) {
  .menu-grid {
    gap: 10px;
  }
  
  .app-tile {
    width: 130px;
    height: 100px;
  }
  
  .app-icon {
    font-size: 1.8em;
  }
  
  .app-name {
    font-size: 0.9em;
  }
  
  .screen-title {
    font-size: 1.8em;
  }
}
</style>
</head>
<body>
<!-- Systemleiste -->
<div class="system-bar">
  <div class="logo">
    <div class="logo-icon">P</div>
    <span>PartexSmartOS 16.2 Ultra</span>
  </div>
  <div class="system-info">
    <span id="current-time">--:--</span>
    <span id="volume-display">üîä 50%</span>
    <span id="network-status">üõú Online</span>
  </div>
</div>

<!-- Hauptcontainer -->
<div class="container">
  <!-- Startscreen -->
  <div id="startScreen" class="visible">
    <h1 class="screen-title">Willkommen bei PartexSmartOS</h1>
    <div class="menu-grid" id="appsGrid">
      <div class="app-tile focused" data-app="youtube">
        <div class="app-icon">‚ñ∂Ô∏è</div>
        <div class="app-name">YouTube</div>
      </div>
      <div class="app-tile" data-app="browser">
        <div class="app-icon">üåê</div>
        <div class="app-name">Browser</div>
      </div>
      <div class="app-tile" data-app="media">
        <div class="app-icon">üé¨</div>
        <div class="app-name">Medien</div>
      </div>
      <div class="app-tile" data-app="store">
        <div class="app-icon">üõí</div>
        <div class="app-name">App Store</div>
      </div>
      <div class="app-tile" data-app="settings">
        <div class="app-icon">‚öôÔ∏è</div>
        <div class="app-name">Einstellungen</div>
      </div>
      <div class="app-tile" data-app="films">
        <div class="app-icon">üé•</div>
        <div class="app-name">Filme & Serien</div>
      </div>
      <div class="app-tile" data-app="calculator">
        <div class="app-icon">üßÆ</div>
        <div class="app-name">Rechner</div>
      </div>
      <div class="app-tile" data-app="notes">
        <div class="app-icon">üìù</div>
        <div class="app-name">Notizen</div>
      </div>
    </div>
    
    <!-- Statusinformation -->
    <div style="text-align: center; margin-top: 40px; opacity: 0.7; font-size: 0.9em;">
      <p>Verwende die Pfeiltasten zur Navigation und Enter zur Auswahl</p>
      <p id="app-hint">Ausgew√§hlt: YouTube</p>
    </div>
  </div>

  <!-- App Store Overlay -->
  <div id="appStoreScreen" class="overlay-screen">
    <div class="overlay-header">
      <h2>App Store</h2>
      <button class="btn" id="closeStore">
        <span>‚úï</span> Schlie√üen
      </button>
    </div>
    <div class="overlay-content scrollable">
      <div class="app-store-grid" id="storeApps">
        <!-- Apps werden via JavaScript geladen -->
      </div>
    </div>
  </div>

  <!-- Einstellungen Overlay -->
  <div id="settingsScreen" class="overlay-screen">
    <div class="overlay-header">
      <h2>Systemeinstellungen</h2>
      <button class="btn" id="closeSettings">
        <span>‚úï</span> Schlie√üen
      </button>
    </div>
    <div class="overlay-content scrollable">
      <div class="settings-grid">
        <div class="setting-card">
          <h3 class="setting-title">Darstellung</h3>
          <div class="setting-option">
            <span>Theme</span>
            <label class="toggle-switch">
              <input type="checkbox" id="themeToggle">
              <span class="toggle-slider"></span>
            </label>
          </div>
          <div class="setting-option">
            <span>Hintergrundanimation</span>
            <label class="toggle-switch">
              <input type="checkbox" id="animationToggle" checked>
              <span class="toggle-slider"></span>
            </label>
          </div>
        </div>
        
        <div class="setting-card">
          <h3 class="setting-title">Audio</h3>
          <div class="setting-option">
            <span>Lautst√§rke</span>
            <span id="volumeValue">50%</span>
          </div>
          <input type="range" min="0" max="100" value="50" class="volume-slider" id="volumeSlider">
          <div style="margin-top: 20px;">
            <button class="btn" id="volumeUp">üîä Lauter</button>
            <button class="btn btn-secondary" id="volumeDown">üîà Leiser</button>
          </div>
        </div>
        
        <div class="setting-card">
          <h3 class="setting-title">System</h3>
          <div class="setting-option">
            <span>Fullscreen Modus</span>
            <button class="btn" id="toggleFullscreen">üñ•Ô∏è Umschalten</button>
          </div>
          <div class="setting-option">
            <span>System-Info</span>
            <button class="btn" id="showSystemInfo">‚ÑπÔ∏è Anzeigen</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Film-Simulation Overlay -->
  <div id="filmsScreen" class="overlay-screen">
    <div class="overlay-header">
      <h2>Filme & Serien</h2>
      <button class="btn" id="closeFilms">
        <span>‚úï</span> Schlie√üen
      </button>
    </div>
    <div class="overlay-content">
      <div class="films-container" id="filmsContainer">
        <!-- Filme werden via JavaScript geladen -->
      </div>
    </div>
  </div>

  <!-- Video Player Overlay -->
  <div id="videoScreen" class="overlay-screen">
    <div class="overlay-header">
      <h2 id="videoTitle">Video Player</h2>
      <button class="btn" id="closeVideo">
        <span>‚úï</span> Schlie√üen
      </button>
    </div>
    <div class="overlay-content">
      <div class="video-player-container">
        <video id="videoPlayer" class="video-player" controls></video>
        <div class="player-controls">
          <button class="control-btn" id="playPause">‚èØÔ∏è Play/Pause</button>
          <button class="control-btn" id="muteToggle">üîá Stummschalten</button>
          <button class="control-btn" id="skipForward">‚è≠Ô∏è 30s vor</button>
          <button class="control-btn" id="skipBackward">‚èÆÔ∏è 30s zur√ºck</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Web Browser Overlay -->
  <div id="browserScreen" class="overlay-screen">
    <div class="overlay-header">
      <h2>Web Browser</h2>
      <div style="display: flex; gap: 10px; flex: 1; margin: 0 20px;">
        <input type="text" id="browserUrl" placeholder="https://example.com" style="flex: 1; padding: 10px; border-radius: 5px; border: none;">
        <button class="btn" id="browserGo">‚ñ∂Ô∏è Los</button>
      </div>
      <button class="btn" id="closeBrowser">
        <span>‚úï</span> Schlie√üen
      </button>
    </div>
    <div class="overlay-content">
      <iframe id="browserFrame" style="width: 100%; height: 100%; border: none; border-radius: 10px;"></iframe>
    </div>
  </div>

  <!-- Mini-Apps Overlays -->
  <div id="calculatorScreen" class="overlay-screen">
    <div class="overlay-header">
      <h2>Rechner</h2>
      <button class="btn" id="closeCalculator">
        <span>‚úï</span> Schlie√üen
      </button>
    </div>
    <div class="overlay-content">
      <div class="mini-app calculator">
        <div class="calc-display" id="calcDisplay">0</div>
        <button class="calc-btn" data-calc="clear">C</button>
        <button class="calc-btn" data-calc="backspace">‚å´</button>
        <button class="calc-btn operator" data-calc="/">/</button>
        <button class="calc-btn operator" data-calc="*">√ó</button>
        <button class="calc-btn" data-calc="7">7</button>
        <button class="calc-btn" data-calc="8">8</button>
        <button class="calc-btn" data-calc="9">9</button>
        <button class="calc-btn operator" data-calc="-">-</button>
        <button class="calc-btn" data-calc="4">4</button>
        <button class="calc-btn" data-calc="5">5</button>
        <button class="calc-btn" data-calc="6">6</button>
        <button class="calc-btn operator" data-calc="+">+</button>
        <button class="calc-btn" data-calc="1">1</button>
        <button class="calc-btn" data-calc="2">2</button>
        <button class="calc-btn" data-calc="3">3</button>
        <button class="calc-btn operator" data-calc="=" rowspan="2">=</button>
        <button class="calc-btn" data-calc="0" colspan="2">0</button>
        <button class="calc-btn" data-calc=".">.</button>
      </div>
    </div>
  </div>

  <div id="notesScreen" class="overlay-screen">
    <div class="overlay-header">
      <h2>Notizen</h2>
      <div style="display: flex; gap: 10px;">
        <button class="btn" id="saveNotes">üíæ Speichern</button>
        <button class="btn" id="clearNotes">üóëÔ∏è L√∂schen</button>
        <button class="btn" id="closeNotes">
          <span>‚úï</span> Schlie√üen
        </button>
      </div>
    </div>
    <div class="overlay-content">
      <div class="mini-app notes-app">
        <textarea id="notesText" placeholder="Hier Ihre Notizen eingeben..."></textarea>
        <div style="margin-top: 15px; font-size: 0.9em; opacity: 0.7;">
          Automatisch gespeichert
        </div>
      </div>
    </div>
  </div>

  <!-- YouTube Overlay -->
  <div id="youtubeScreen" class="overlay-screen">
    <div class="overlay-header">
      <h2>YouTube</h2>
      <div style="display: flex; gap: 10px; flex: 1; margin: 0 20px;">
        <input type="text" id="youtubeSearch" placeholder="YouTube durchsuchen..." style="flex: 1; padding: 10px; border-radius: 5px; border: none;">
        <button class="btn" id="youtubeSearchBtn">üîç Suchen</button>
      </div>
      <button class="btn" id="closeYoutube">
        <span>‚úï</span> Schlie√üen
      </button>
    </div>
    <div class="overlay-content">
      <iframe id="youtubeFrame" style="width: 100%; height: 100%; border: none; border-radius: 10px;" 
              src="https://www.youtube.com/embed?autoplay=1&mute=0" 
              allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
              allowfullscreen>
      </iframe>
    </div>
  </div>
</div>

<script>
// -------------------- Globale Variablen --------------------
let currentApp = 'youtube';
let currentFocus = 0;
let volume = 50;
let isDarkTheme = true;
let backgroundAnimation = true;
let appTiles = [];
let currentScreen = 'startScreen';
let calcValue = '0';
let calcOperation = null;
let calcPreviousValue = null;

// -------------------- Systeminitialisierung --------------------
function initSystem() {
  // App-Tiles sammeln
  appTiles = Array.from(document.querySelectorAll('.app-tile'));
  
  // Systemzeit aktualisieren
  updateTime();
  setInterval(updateTime, 1000);
  
  // Volumen-Anzeige aktualisieren
  updateVolumeDisplay();
  
  // App-Store Apps laden
  loadAppStore();
  
  // Filme laden
  loadFilms();
  
  // Notizen laden
  loadNotes();
  
  // Event Listeners f√ºr Buttons
  setupEventListeners();
  
  // Fokus setzen
  updateFocus();
}

// -------------------- Zeit und Systeminfo --------------------
function updateTime() {
  const now = new Date();
  const timeString = now.toLocaleTimeString('de-DE', { hour: '2-digit', minute: '2-digit' });
  const dateString = now.toLocaleDateString('de-DE', { weekday: 'long', day: 'numeric', month: 'long' });
  
  document.getElementById('current-time').textContent = `${dateString} | ${timeString}`;
}

function updateVolumeDisplay() {
  const volumeIcon = volume === 0 ? 'üîà' : volume < 30 ? 'üîâ' : 'üîä';
  document.getElementById('volume-display').textContent = `${volumeIcon} ${volume}%`;
  document.getElementById('volumeValue').textContent = `${volume}%`;
  document.getElementById('volumeSlider').value = volume;
}

// -------------------- Fokus Navigation --------------------
function updateFocus() {
  appTiles.forEach((tile, index) => {
    tile.classList.toggle('focused', index === currentFocus);
  });
  
  const appName = appTiles[currentFocus]?.dataset.app || 'YouTube';
  document.getElementById('app-hint').textContent = `Ausgew√§hlt: ${appName.charAt(0).toUpperCase() + appName.slice(1)}`;
}

// -------------------- Screens wechseln --------------------
function showScreen(screenId) {
  // Alle Screens ausblenden
  document.querySelectorAll('.overlay-screen').forEach(screen => {
    screen.classList.remove('visible');
  });
  document.getElementById('startScreen').classList.add('hidden');
  
  // Gew√ºnschten Screen anzeigen
  if (screenId === 'startScreen') {
    document.getElementById('startScreen').classList.remove('hidden');
    currentScreen = 'startScreen';
  } else {
    document.getElementById(screenId).classList.add('visible');
    currentScreen = screenId;
  }
}

// -------------------- App Store --------------------
function loadAppStore() {
  const storeApps = [
    { name: 'Wetter', icon: 'üå§Ô∏è', desc: 'Aktuelle Wetterdaten', category: 'Tools' },
    { name: 'Rechner', icon: 'üßÆ', desc: 'Wissenschaftlicher Rechner', category: 'Tools' },
    { name: 'Notizen', icon: 'üìù', desc: 'Textnotizen verwalten', category: 'Produktivit√§t' },
    { name: 'Kalender', icon: 'üìÖ', desc: 'Termine verwalten', category: 'Produktivit√§t' },
    { name: 'Maps', icon: 'üó∫Ô∏è', desc: 'Karten und Navigation', category: 'Navigation' },
    { name: 'Musik', icon: 'üéµ', desc: 'Musikplayer', category: 'Unterhaltung' },
    { name: 'Foto', icon: 'üì∑', desc: 'Fotogalerie', category: 'Medien' },
    { name: 'News', icon: 'üì∞', desc: 'Nachrichten lesen', category: 'Information' },
    { name: 'Spiele', icon: 'üéÆ', desc: 'Mini-Spiele', category: 'Unterhaltung' },
    { name: 'Dateien', icon: 'üìÅ', desc: 'Dateimanager', category: 'System' }
  ];
  
  const container = document.getElementById('storeApps');
  container.innerHTML = '';
  
  storeApps.forEach(app => {
    const appEl = document.createElement('div');
    appEl.className = 'store-app';
    appEl.innerHTML = `
      <div style="font-size: 3em; margin-bottom: 15px;">${app.icon}</div>
      <h3 style="margin-bottom: 5px;">${app.name}</h3>
      <p style="font-size: 0.9em; opacity: 0.8; margin-bottom: 10px;">${app.desc}</p>
      <div style="display: flex; justify-content: space-between; align-items: center;">
        <span style="font-size: 0.8em; background: #333; padding: 3px 8px; border-radius: 10px;">${app.category}</span>
        <button class="btn" style="padding: 5px 15px; font-size: 0.9em;">Installieren</button>
      </div>
    `;
    container.appendChild(appEl);
  });
}

// -------------------- Film-Simulation --------------------
function loadFilms() {
  const films = [
    { 
      title: 'Action Abenteuer', 
      year: 2024, 
      duration: '2h 15m',
      video: 'https://www.w3schools.com/html/mov_bbb.mp4',
      poster: 'https://images.unsplash.com/photo-1536440136628-849c177e76a1?w=400&h=600&fit=crop'
    },
    { 
      title: 'Science Fiction', 
      year: 2023, 
      duration: '2h 45m',
      video: 'https://www.w3schools.com/html/movie.mp4',
      poster: 'https://images.unsplash.com/photo-1533616688419-b7a585564f70?w=400&h=600&fit=crop'
    },
    { 
      title: 'Drama', 
      year: 2022, 
      duration: '1h 55m',
      video: 'https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4',
      poster: 'https://images.unsplash.com/photo-1489599809516-9827b6d1cf13?w=400&h=600&fit=crop'
    },
    { 
      title: 'Kom√∂die', 
      year: 2024, 
      duration: '1h 40m',
      video: 'https://www.w3schools.com/html/mov_bbb.mp4',
      poster: 'https://images.unsplash.com/photo-1517604931442-7e0c8ed2963c?w=400&h=600&fit=crop'
    },
    { 
      title: 'Thriller', 
      year: 2023, 
      duration: '2h 10m',
      video: 'https://www.w3schools.com/html/movie.mp4',
      poster: 'https://images.unsplash.com/photo-1531259683007-016a7b628fc3?w=400&h=600&fit=crop'
    }
  ];
  
  const container = document.getElementById('filmsContainer');
  container.innerHTML = '';
  
  films.forEach((film, index) => {
    const filmEl = document.createElement('div');
    filmEl.className = 'film-item';
    if (index === 0) filmEl.classList.add('focused');
    filmEl.style.backgroundImage = `url('${film.poster}')`;
    filmEl.dataset.video = film.video;
    filmEl.dataset.title = film.title;
    
    filmEl.innerHTML = `
      <div class="film-info">
        <div class="film-title">${film.title}</div>
        <div class="film-year">${film.year} ‚Ä¢ ${film.duration}</div>
        <button class="btn" style="margin-top: 10px; padding: 8px 15px; font-size: 0.9em;">‚ñ∂Ô∏è Abspielen</button>
      </div>
    `;
    
    filmEl.addEventListener('click', () => {
      playVideo(film.video, film.title);
    });
    
    container.appendChild(filmEl);
  });
}

// -------------------- Video Player --------------------
function playVideo(videoUrl, title) {
  const player = document.getElementById('videoPlayer');
  const titleEl = document.getElementById('videoTitle');
  
  player.src = videoUrl;
  titleEl.textContent = title || 'Video Player';
  showScreen('videoScreen');
  
  // Auto-play
  setTimeout(() => {
    player.play().catch(e => console.log('Auto-play wurde blockiert:', e));
  }, 500);
}

// -------------------- Notizen --------------------
function loadNotes() {
  const savedNotes = localStorage.getItem('partexsmartos_notes');
  if (savedNotes) {
    document.getElementById('notesText').value = savedNotes;
  }
}

function saveNotes() {
  const notes = document.getElementById('notesText').value;
  localStorage.setItem('partexsmartos_notes', notes);
}

// -------------------- Rechner --------------------
function handleCalcInput(value) {
  const display = document.getElementById('calcDisplay');
  
  if (value === 'clear') {
    calcValue = '0';
    calcOperation = null;
    calcPreviousValue = null;
  } else if (value === 'backspace') {
    calcValue = calcValue.length > 1 ? calcValue.slice(0, -1) : '0';
  } else if (value === '=') {
    if (calcOperation && calcPreviousValue !== null) {
      const prev = parseFloat(calcPreviousValue);
      const current = parseFloat(calcValue);
      let result = 0;
      
      switch(calcOperation) {
        case '+': result = prev + current; break;
        case '-': result = prev - current; break;
        case '*': result = prev * current; break;
        case '/': result = current !== 0 ? prev / current : 'Error'; break;
      }
      
      calcValue = result.toString();
      calcOperation = null;
      calcPreviousValue = null;
    }
  } else if (['+', '-', '*', '/'].includes(value)) {
    calcOperation = value;
    calcPreviousValue = calcValue;
    calcValue = '0';
  } else {
    // Zahlen oder Punkt
    if (calcValue === '0' && value !== '.') {
      calcValue = value;
    } else {
      if (value === '.' && calcValue.includes('.')) return;
      calcValue += value;
    }
  }
  
  display.textContent = calcValue;
}

// -------------------- Event Listeners --------------------
function setupEventListeners() {
  // App-Tiles Klick
  appTiles.forEach((tile, index) => {
    tile.addEventListener('click', () => {
      currentFocus = index;
      updateFocus();
      openApp(tile.dataset.app);
    });
  });
  
  // Navigation mit Tastatur
  document.addEventListener('keydown', (e) => {
    if (currentScreen !== 'startScreen') return;
    
    switch(e.key) {
      case 'ArrowRight':
        currentFocus = (currentFocus + 1) % appTiles.length;
        updateFocus();
        break;
      case 'ArrowLeft':
        currentFocus = (currentFocus - 1 + appTiles.length) % appTiles.length;
        updateFocus();
        break;
      case 'ArrowUp':
        if (currentFocus >= 4) {
          currentFocus -= 4;
          updateFocus();
        }
        break;
      case 'ArrowDown':
        if (currentFocus < 4) {
          currentFocus += 4;
          updateFocus();
        }
        break;
      case 'Enter':
        openApp(appTiles[currentFocus].dataset.app);
        break;
      case 'Escape':
        showScreen('startScreen');
        break;
    }
  });
  
  // App-√ñffnen Funktion
  function openApp(appName) {
    currentApp = appName;
    
    switch(appName) {
      case 'youtube':
        showScreen('youtubeScreen');
        break;
      case 'browser':
        showScreen('browserScreen');
        break;
      case 'media':
        playVideo('https://www.w3schools.com/html/mov_bbb.mp4', 'Beispiel Video');
        break;
      case 'store':
        showScreen('appStoreScreen');
        break;
      case 'settings':
        showScreen('settingsScreen');
        break;
      case 'films':
        showScreen('filmsScreen');
        break;
      case 'calculator':
        showScreen('calculatorScreen');
        break;
      case 'notes':
        showScreen('notesScreen');
        break;
    }
  }
  
  // Close Buttons
  document.getElementById('closeStore').addEventListener('click', () => showScreen('startScreen'));
  document.getElementById('closeSettings').addEventListener('click', () => showScreen('startScreen'));
  document.getElementById('closeFilms').addEventListener('click', () => showScreen('startScreen'));
  document.getElementById('closeVideo').addEventListener('click', () => showScreen('startScreen'));
  document.getElementById('closeBrowser').addEventListener('click', () => showScreen('startScreen'));
  document.getElementById('closeCalculator').addEventListener('click', () => showScreen('startScreen'));
  document.getElementById('closeNotes').addEventListener('click', () => {
    saveNotes();
    showScreen('startScreen');
  });
  document.getElementById('closeYoutube').addEventListener('click', () => showScreen('startScreen'));
  
  // Browser Controls
  document.getElementById('browserGo').addEventListener('click', () => {
    let url = document.getElementById('browserUrl').value;
    if (!url.startsWith('http')) {
      url = 'https://' + url;
    }
    document.getElementById('browserFrame').src = url;
  });
  
  document.getElementById('browserUrl').addEventListener('keypress', (e) => {
    if (e.key === 'Enter') {
      document.getElementById('browserGo').click();
    }
  });
  
  // YouTube Controls
  document.getElementById('youtubeSearchBtn').addEventListener('click', () => {
    const query = document.getElementById('youtubeSearch').value;
    if (query) {
      const encodedQuery = encodeURIComponent(query);
      document.getElementById('youtubeFrame').src = 
        `https://www.youtube.com/embed?autoplay=1&list=search?query=${encodedQuery}`;
    }
  });
  
  // Video Player Controls
  document.getElementById('playPause').addEventListener('click', () => {
    const player = document.getElementById('videoPlayer');
    if (player.paused) {
      player.play();
    } else {
      player.pause();
    }
  });
  
  document.getElementById('muteToggle').addEventListener('click', () => {
    const player = document.getElementById('videoPlayer');
    player.muted = !player.muted;
  });
  
  document.getElementById('skipForward').addEventListener('click', () => {
    const player = document.getElementById('videoPlayer');
    player.currentTime += 30;
  });
  
  document.getElementById('skipBackward').addEventListener('click', () => {
    const player = document.getElementById('videoPlayer');
    player.currentTime = Math.max(0, player.currentTime - 30);
  });
  
  // Settings Controls
  document.getElementById('themeToggle').addEventListener('change', (e) => {
    isDarkTheme = !e.target.checked;
    if (isDarkTheme) {
      document.body.classList.remove('light-theme');
    } else {
      document.body.classList.add('light-theme');
    }
  });
  
  document.getElementById('animationToggle').addEventListener('change', (e) => {
    backgroundAnimation = e.target.checked;
    if (backgroundAnimation) {
      document.body.style.animation = 'none';
    } else {
      document.body.style.animation = 'pulse 10s infinite alternate';
    }
  });
  
  document.getElementById('volumeSlider').addEventListener('input', (e) => {
    volume = parseInt(e.target.value);
    updateVolumeDisplay();
  });
  
  document.getElementById('volumeUp').addEventListener('click', () => {
    volume = Math.min(100, volume + 10);
    updateVolumeDisplay();
  });
  
  document.getElementById('volumeDown').addEventListener('click', () => {
    volume = Math.max(0, volume - 10);
    updateVolumeDisplay();
  });
  
  document.getElementById('toggleFullscreen').addEventListener('click', () => {
    if (!document.fullscreenElement) {
      document.documentElement.requestFullscreen();
    } else {
      document.exitFullscreen();
    }
  });
  
  document.getElementById('showSystemInfo').addEventListener('click', () => {
    alert(`PartexSmartOS 16.2 Ultra\nVersion: 16.2.0\nBenutzer: Gast\nSpeicher: 2.3 GB frei\nNetzwerk: Online`);
  });
  
  // Calculator Controls
  document.querySelectorAll('.calc-btn').forEach(button => {
    button.addEventListener('click', () => {
      handleCalcInput(button.dataset.calc);
    });
  });
  
  // Notes Controls
  document.getElementById('saveNotes').addEventListener('click', saveNotes);
  document.getElementById('clearNotes').addEventListener('click', () => {
    if (confirm('Alle Notizen l√∂schen?')) {
      document.getElementById('notesText').value = '';
      localStorage.removeItem('partexsmartos_notes');
    }
  });
  
  // Auto-save notes
  document.getElementById('notesText').addEventListener('input', saveNotes);
}

// -------------------- Initialisierung --------------------
document.addEventListener('DOMContentLoaded', initSystem);

// Fullscreen Change Detection
document.addEventListener('fullscreenchange', () => {
  const button = document.getElementById('toggleFullscreen');
  if (document.fullscreenElement) {
    button.textContent = 'üñ•Ô∏è Vollbild verlassen';
  } else {
    button.textContent = 'üñ•Ô∏è Vollbild aktivieren';
  }
});
</script>
</body>
</html>
